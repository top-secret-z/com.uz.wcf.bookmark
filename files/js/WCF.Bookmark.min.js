WCF.Bookmark={};WCF.Bookmark.UserPanel=WCF.User.Panel.Abstract.extend({init:function(a){a.enableMarkAsRead=true;this._super($("#unreadBookmarks"),"unreadBookmarks",a);WCF.System.Event.addListener("com.uz.wsc.bookmark.userPanel","reset",(function(){this.resetItems();this.updateBadge(0);this._loadData=true}).bind(this));require(["EventHandler"],(function(b){b.add("com.woltlab.wcf.UserMenuMobile","more",(function(c){if(c.identifier==="com.uz.wsc.bookmark"){this.toggle()}}).bind(this))}).bind(this))},_initDropdown:function(){var a=this._super();$('<li class="jsOnly"><a href="#" data-object-id="0" class="jsAddBookmarkMenu jsTooltip" title="'+this._options.newBookmark+'"><span class="icon icon16 fa-plus"></span> <span class="invisible">'+this._options.newBookmark+"</span></a></li>").appendTo(a.getLinkList());require(["UZ/Bookmark/Add"],function(b){new b("","","",".jsAddBookmarkMenu")});return a},_load:function(){this._proxy.setOption("data",{actionName:"getMixedShareList",className:"wcf\\data\\bookmark\\share\\BookmarkShareAction",});this._proxy.sendRequest()},_markAsRead:function(a,b){this._proxy.setOption("data",{actionName:"markAsRead",className:"wcf\\data\\bookmark\\share\\BookmarkShareAction",objectIDs:[b]});this._proxy.sendRequest()},_markAllAsRead:function(a){this._proxy.setOption("data",{actionName:"markAllAsRead",className:"wcf\\data\\bookmark\\share\\BookmarkShareAction",});this._proxy.sendRequest()}});WCF.Bookmark.Loader=Class.extend({_container:null,_bookmarkAccess:"all",_bookmarkType:"all",_loadButton:null,_noMoreEntries:null,_proxy:null,_userID:0,_inlineEditor:null,init:function(a){this._container=$("#bookmarkList");this._userID=a;if(!this._userID){console.debug("[WCF.Bookmark.Loader] Invalid parameter 'userID' given.");return}this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});var b=$('<li class="bookmarkListMore showMore"><button class="small">'+WCF.Language.get("wcf.bookmark.profile.moreItems")+"</button><small>"+WCF.Language.get("wcf.bookmark.profile.noMoreItems")+"</small></li>").appendTo(this._container);this._loadButton=b.children("button").click($.proxy(this._click,this));this._noMoreEntries=b.children("small").hide();if(this._container.find("> li").length==2){this._loadButton.hide();this._noMoreEntries.show()}$("#bookmarkAccess .button").click($.proxy(this._clickBookmarkAccess,this));$("#bookmarkType").on("click","li",$.proxy(this._clickBookmarkType,this));this._inlineEditor=new WCF.Bookmark.InlineEditor(".bookmark")},_clickBookmarkAccess:function(a){var b=$(a.currentTarget);if(this._bookmarkAccess!=b.data("bookmarkAccess")){this._bookmarkAccess=b.data("bookmarkAccess");$("#bookmarkAccess .button").removeClass("active");b.addClass("active");this._reload()}},_clickBookmarkType:function(a){$("#bookmarkTypeSelector").text($(a.currentTarget).text());this._bookmarkType=$(a.currentTarget).attr("id");this._reload()},_reload:function(){this._container.find("> li:not(:first-child):not(:last-child)").remove();this._container.data("lastBookmarkTime",0);this._click()},_click:function(){this._loadButton.enable();var a={lastBookmarkTime:this._container.data("lastBookmarkTime"),userID:this._userID,bookmarkAccess:this._bookmarkAccess,bookmarkType:this._bookmarkType};this._proxy.setOption("data",{actionName:"load",className:"wcf\\data\\bookmark\\BookmarkAction",parameters:a});this._proxy.sendRequest()},_success:function(b,c,a){if(b.returnValues.template){$(b.returnValues.template).insertBefore(this._loadButton.parent());this._container.data("lastBookmarkTime",b.returnValues.lastBookmarkTime);this._noMoreEntries.hide();this._loadButton.show().enable()}else{this._noMoreEntries.show();this._loadButton.hide()}this._inlineEditor=new WCF.Bookmark.InlineEditor(".bookmark")}});WCF.Bookmark.InlineEditor=WCF.InlineEditor.extend({_setOptions:function(){this._dropdowns=[];this._options=[{label:WCF.Language.get("wcf.bookmark.edit.edit"),optionName:"edit"},{label:WCF.Language.get("wcf.bookmark.edit.delete"),optionName:"delete"}];var b=elById("bookmarkList");var a=elData(b,"share-enable");if(a=="1"){this._options.push({optionName:"divider"});this._options.push({label:WCF.Language.get("wcf.bookmark.edit.share"),optionName:"share"})}},rebuild:function(){var b=$(this._elementSelector);var a=this;b.each(function(e,f){var d=$(f);var g=d.wcfIdentify();var c=a._getTriggerElement(d);if(c===null||c.length!==1){return}c.on(WCF_CLICK_EVENT,$.proxy(a._show,a)).data("elementID",g);if(a._quickOption){c.disableSelection().data("optionName",a._quickOption).dblclick($.proxy(a._click,a))}a._elements[g]=d})},_getTriggerElement:function(a){return a.find(".jsBookmarkEditor")},_validate:function(a,b){return true},_execute:function(a,b){if(!this._validate(a,b)){return false}switch(b){case"edit":require(["UZ/Bookmark/Edit"],function(c){new c(document.getElementById(a).getAttribute("data-bookmark-id"),"edit")});break;case"delete":require(["UZ/Bookmark/Delete"],function(c){new c(document.getElementById(a).getAttribute("data-bookmark-id"))});break;case"share":require(["UZ/Bookmark/Share"],function(c){new c(document.getElementById(a).getAttribute("data-bookmark-id"))});break}}});